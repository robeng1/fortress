var Y=Object.defineProperty,G=Object.defineProperties;var X=Object.getOwnPropertyDescriptors;var L=Object.getOwnPropertySymbols;var Z=Object.prototype.hasOwnProperty,K=Object.prototype.propertyIsEnumerable;var U=(r,e,t)=>e in r?Y(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t,y=(r,e)=>{for(var t in e||(e={}))Z.call(e,t)&&U(r,t,e[t]);if(L)for(var t of L(e))K.call(e,t)&&U(r,t,e[t]);return r},g=(r,e)=>G(r,X(e));import{e as h,z as ee,j as p,m as te,d as c,L as se}from"./vendor.58b0d04f.js";import{T as F}from"./index.e628a3e4.js";class H extends Error{constructor(e,t,s){const o=e.status||e.status===0?e.status:"",i=e.statusText||"",n=`${o} ${i}`.trim(),a=n?`status code ${n}`:"an unknown error";super(`Request failed with ${a}`);this.name="HTTPError",this.response=e,this.request=t,this.options=s}}class D extends Error{constructor(e){super("Request timed out");this.name="TimeoutError",this.request=e}}const w=r=>r!==null&&typeof r=="object",x=(...r)=>{for(const e of r)if((!w(e)||Array.isArray(e))&&typeof e!="undefined")throw new TypeError("The `options` argument must be an object");return N({},...r)},M=(r={},e={})=>{const t=new globalThis.Headers(r),s=e instanceof globalThis.Headers,o=new globalThis.Headers(e);for(const[i,n]of o.entries())s&&n==="undefined"||n===void 0?t.delete(i):t.set(i,n);return t},N=(...r)=>{let e={},t={};for(const s of r)if(Array.isArray(s))Array.isArray(e)||(e=[]),e=[...e,...s];else if(w(s)){for(let[o,i]of Object.entries(s))w(i)&&o in e&&(i=N(e[o],i)),e=g(y({},e),{[o]:i});w(s.headers)&&(t=M(t,s.headers),e.headers=t)}return e},re=typeof globalThis.AbortController=="function",oe=typeof globalThis.ReadableStream=="function",ne=typeof globalThis.FormData=="function",z=["get","post","put","patch","head","delete"],ie={json:"application/json",text:"text/*",formData:"multipart/form-data",arrayBuffer:"*/*",blob:"*/*"},E=2147483647,I=Symbol("stop"),ae=r=>z.includes(r)?r.toUpperCase():r,ce=["get","put","head","delete","options","trace"],le=[408,413,429,500,502,503,504],$=[413,429,503],B={limit:2,methods:ce,statusCodes:le,afterStatusCodes:$,maxRetryAfter:Number.POSITIVE_INFINITY},ue=(r={})=>{if(typeof r=="number")return g(y({},B),{limit:r});if(r.methods&&!Array.isArray(r.methods))throw new Error("retry.methods must be an array");if(r.statusCodes&&!Array.isArray(r.statusCodes))throw new Error("retry.statusCodes must be an array");return g(y(y({},B),r),{afterStatusCodes:$})},he=async(r,e,t)=>new Promise((s,o)=>{const i=setTimeout(()=>{e&&e.abort(),o(new D(r))},t.timeout);t.fetch(r).then(s).catch(o).then(()=>{clearTimeout(i)})}),de=async r=>new Promise(e=>{setTimeout(e,r)});class R{constructor(e,t={}){var s,o;if(this._retryCount=0,this._input=e,this._options=g(y({credentials:this._input.credentials||"same-origin"},t),{headers:M(this._input.headers,t.headers),hooks:N({beforeRequest:[],beforeRetry:[],afterResponse:[]},t.hooks),method:ae((s=t.method)!==null&&s!==void 0?s:this._input.method),prefixUrl:String(t.prefixUrl||""),retry:ue(t.retry),throwHttpErrors:t.throwHttpErrors!==!1,timeout:typeof t.timeout=="undefined"?1e4:t.timeout,fetch:(o=t.fetch)!==null&&o!==void 0?o:globalThis.fetch.bind(globalThis)}),typeof this._input!="string"&&!(this._input instanceof URL||this._input instanceof globalThis.Request))throw new TypeError("`input` must be a string, URL, or Request");if(this._options.prefixUrl&&typeof this._input=="string"){if(this._input.startsWith("/"))throw new Error("`input` must not begin with a slash when using `prefixUrl`");this._options.prefixUrl.endsWith("/")||(this._options.prefixUrl+="/"),this._input=this._options.prefixUrl+this._input}if(re&&(this.abortController=new globalThis.AbortController,this._options.signal&&this._options.signal.addEventListener("abort",()=>{this.abortController.abort()}),this._options.signal=this.abortController.signal),this.request=new globalThis.Request(this._input,this._options),this._options.searchParams){const i=typeof this._options.searchParams=="string"?this._options.searchParams.replace(/^\?/,""):new URLSearchParams(this._options.searchParams).toString(),n="?"+i,a=this.request.url.replace(/(?:\?.*?)?(?=#|$)/,n);(ne&&this._options.body instanceof globalThis.FormData||this._options.body instanceof URLSearchParams)&&!(this._options.headers&&this._options.headers["content-type"])&&this.request.headers.delete("content-type"),this.request=new globalThis.Request(new globalThis.Request(a,this.request),this._options)}this._options.json!==void 0&&(this._options.body=JSON.stringify(this._options.json),this.request.headers.set("content-type","application/json"),this.request=new globalThis.Request(this.request,{body:this._options.body}))}static create(e,t){const s=new R(e,t),o=async()=>{if(s._options.timeout>E)throw new RangeError(`The \`timeout\` option cannot be greater than ${E}`);await Promise.resolve();let a=await s._fetch();for(const m of s._options.hooks.afterResponse){const u=await m(s.request,s._options,s._decorateResponse(a.clone()));u instanceof globalThis.Response&&(a=u)}if(s._decorateResponse(a),!a.ok&&s._options.throwHttpErrors)throw new H(a,s.request,s._options);if(s._options.onDownloadProgress){if(typeof s._options.onDownloadProgress!="function")throw new TypeError("The `onDownloadProgress` option must be a function");if(!oe)throw new Error("Streams are not supported in your environment. `ReadableStream` is missing.");return s._stream(a.clone(),s._options.onDownloadProgress)}return a},n=s._options.retry.methods.includes(s.request.method.toLowerCase())?s._retry(o):o();for(const[a,m]of Object.entries(ie))n[a]=async()=>{s.request.headers.set("accept",s.request.headers.get("accept")||m);const u=(await n).clone();if(a==="json"){if(u.status===204)return"";if(t.parseJson)return t.parseJson(await u.text())}return u[a]()};return n}_calculateRetryDelay(e){if(this._retryCount++,this._retryCount<this._options.retry.limit&&!(e instanceof D)){if(e instanceof H){if(!this._options.retry.statusCodes.includes(e.response.status))return 0;const s=e.response.headers.get("Retry-After");if(s&&this._options.retry.afterStatusCodes.includes(e.response.status)){let o=Number(s);return Number.isNaN(o)?o=Date.parse(s)-Date.now():o*=1e3,typeof this._options.retry.maxRetryAfter!="undefined"&&o>this._options.retry.maxRetryAfter?0:o}if(e.response.status===413)return 0}return .3*2**(this._retryCount-1)*1e3}return 0}_decorateResponse(e){return this._options.parseJson&&(e.json=async()=>this._options.parseJson(await e.text())),e}async _retry(e){try{return await e()}catch(t){const s=Math.min(this._calculateRetryDelay(t),E);if(s!==0&&this._retryCount>0){await de(s);for(const o of this._options.hooks.beforeRetry)if(await o({request:this.request,options:this._options,error:t,retryCount:this._retryCount})===I)return;return this._retry(e)}throw t}}async _fetch(){for(const e of this._options.hooks.beforeRequest){const t=await e(this.request,this._options);if(t instanceof Request){this.request=t;break}if(t instanceof Response)return t}return this._options.timeout===!1?this._options.fetch(this.request.clone()):he(this.request.clone(),this.abortController,this._options)}_stream(e,t){const s=Number(e.headers.get("content-length"))||0;let o=0;return new globalThis.Response(new globalThis.ReadableStream({async start(i){const n=e.body.getReader();t&&t({percent:0,transferredBytes:0,totalBytes:s},new Uint8Array);async function a(){const{done:m,value:u}=await n.read();if(m){i.close();return}if(t){o+=u.byteLength;const T=s===0?0:o/s;t({percent:T,transferredBytes:o,totalBytes:s},u)}i.enqueue(u),await a()}await a()}}))}}/*! MIT License Â© Sindre Sorhus */const A=r=>{const e=(t,s)=>R.create(t,x(r,s));for(const t of z)e[t]=(s,o)=>R.create(s,x(r,o,{method:t}));return e.create=t=>A(x(t)),e.extend=t=>A(x(r,t)),e.stop=I,e},fe=A();var pe=fe;function me(r,e){const[t,s]=h.exports.useState(r);return h.exports.useEffect(()=>{const o=setTimeout(()=>{s(r)},e);return()=>{clearTimeout(o)}},[r,e]),t}const ye=[];function we({id:r,searchId:e,modalOpen:t,setModalOpen:s,queryURL:o,composeQuery:i,matchKey:n,queryKey:a,handleResultSelected:m,alreadySelected:u=ye,placeholder:T="Anything",queryEnabled:J=!1}){const[k,j]=h.exports.useState(!1),[b,_]=h.exports.useState([]),[P,V]=h.exports.useState(""),v=me(P,500),{data:d}=ee([a,v],()=>pe.post(`${o}`,{body:JSON.stringify({query:i(v)})}).json(),{enabled:J&&Boolean(v)}),S=h.exports.useRef(null),C=h.exports.useRef(null),O=()=>{j(!k),_(d?d.result:[]),k&&_([])},W=l=>{const{id:f,checked:Q}=l.target;j(!1),_([...b,d==null?void 0:d.result.find(q=>q[n]===f)]),Q||_(b.filter(q=>q[n]!==f))};return h.exports.useEffect(()=>{m(b)},[b]),h.exports.useEffect(()=>{const l=({target:f})=>{!t||S.current&&S.current.contains(f)||s(!1)};return document.addEventListener("click",l),()=>document.removeEventListener("click",l)}),h.exports.useEffect(()=>{const l=({keyCode:f})=>{!t||f!==27||s(!1)};return document.addEventListener("keydown",l),()=>document.removeEventListener("keydown",l)}),h.exports.useEffect(()=>{t&&C.current&&C.current.focus()},[t]),p(te,{children:[c(F,{className:"fixed inset-0 bg-gray-900 bg-opacity-30 z-50 transition-opacity",show:t,appear:!0,enter:"transition ease-out duration-200",enterStart:"opacity-0",enterEnd:"opacity-100",leave:"transition ease-out duration-100",leaveStart:"opacity-100",leaveEnd:"opacity-0","aria-hidden":"true"}),c(F,{id:r,appear:!0,className:"fixed inset-0 z-50 overflow-hidden flex items-start top-20 mb-4 justify-center transform px-4 sm:px-6",role:"dialog","aria-modal":"true",show:t,enter:"transition ease-in-out duration-200",enterStart:"opacity-0 translate-y-4",enterEnd:"opacity-100 translate-y-0",leave:"transition ease-in-out duration-200",leaveStart:"opacity-100 translate-y-0",leaveEnd:"opacity-0 translate-y-4",children:p("div",{ref:S,className:"bg-white overflow-auto max-w-2xl w-full max-h-full rounded shadow-lg",children:[c("form",{className:"border-b border-gray-200 z-20",children:p("div",{className:"relative",children:[c("label",{htmlFor:e,className:"sr-only",children:"Search"}),c("input",{id:e,className:"w-full border-0 focus:ring-transparent placeholder-gray-400 appearance-none py-3 pl-10 pr-4",type:"search",onChange:l=>V(l.target.value),value:P,placeholder:`Search ${T}...`,ref:C}),c("button",{className:"absolute inset-0 right-auto group",type:"submit","aria-label":"Search",children:p("svg",{className:"w-4 h-4 flex-shrink-0 fill-current text-gray-400 group-hover:text-gray-500 ml-4 mr-2",viewBox:"0 0 16 16",xmlns:"http://www.w3.org/2000/svg",children:[c("path",{d:"M7 14c-3.86 0-7-3.14-7-7s3.14-7 7-7 7 3.14 7 7-3.14 7-7 7zM7 2C4.243 2 2 4.243 2 7s2.243 5 5 5 5-2.243 5-5-2.243-5-5-5z"}),c("path",{d:"M15.707 14.293L13.314 11.9a8.019 8.019 0 01-1.414 1.414l2.393 2.393a.997.997 0 001.414 0 .999.999 0 000-1.414z"})]})})]})}),d&&c("div",{className:"py-4 px-2",children:p("div",{className:"mb-3 last:mb-0",children:[c("div",{className:"text-xs font-semibold text-gray-400 uppercase px-2 mb-2",children:"Results"}),c("div",{className:"flex items-center",children:p("label",{className:"inline-flex",children:[c("span",{className:"sr-only",children:"Select all"}),c("input",{className:"form-checkbox",type:"checkbox",checked:k,onChange:O})]})}),c("ul",{className:"text-sm",children:d==null?void 0:d.result.filter(l=>!u.includes(l[n])).map(l=>c("li",{children:p(se,{className:"flex items-center p-2 text-gray-800 hover:text-white hover:bg-purple-500 rounded group",to:"#0",onClick:()=>s(!t),children:[p("label",{className:"inline-flex flex-shrink-0 mr-3",children:[c("span",{className:"sr-only",children:"Select"}),c("input",{id:l[n],className:"form-checkbox",type:"checkbox",onChange:W,checked:b.some(f=>f[n]===l[n])})]}),c("div",{className:"w-10 h-10 flex-shrink-0 mr-2 sm:mr-3",children:c("img",{className:"",src:l.image_url,width:"40",height:"40",alt:l.label})}),c("span",{children:l.label})]})},l[n]))})]})})]})})]})}export{we as S};
