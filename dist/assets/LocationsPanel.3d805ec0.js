var ae=Object.defineProperty,re=Object.defineProperties;var ie=Object.getOwnPropertyDescriptors;var R=Object.getOwnPropertySymbols;var ce=Object.prototype.hasOwnProperty,le=Object.prototype.propertyIsEnumerable;var G=(s,o,r)=>o in s?ae(s,o,{enumerable:!0,configurable:!0,writable:!0,value:r}):s[o]=r,x=(s,o)=>{for(var r in o||(o={}))ce.call(o,r)&&G(s,r,o[r]);if(R)for(var r of R(o))le.call(o,r)&&G(s,r,o[r]);return s},q=(s,o)=>re(s,ie(o));import{d as i,m as $,j as u,an as ue,e as w,ac as de,u as Q,z as pe,g as J,F as me,ad as W,k as ge}from"./vendor.58b0d04f.js";import{l as fe}from"./index.5f62a056.js";import{b as he,a as ve,r as I}from"./index.e628a3e4.js";import{l as ye}from"./location.f8680506.js";function be({handleShow:s,location:o}){return i($,{children:i("div",{onClick:r=>s(!0,o.centre_id),className:"py-1 px-3 mb-4 md:p-5 text-coolGray-800 shadow rounded-lg",children:u("div",{className:"flex md:space-y-0 md:space-x-6 align-top",children:[i("img",{src:"https://source.unsplash.com/70x70/?portrait",alt:"",className:"md:self-center self-start flex-shrink-0 w-20 h-20 border rounded-sm justify-self-start bg-coolGray-500 border-coolGray-300"}),u("div",{className:"flex flex-col px-3 md:px-0",children:[u("div",{className:"flex md:space-x-6 flex-row",children:[i("h4",{className:"text-sm md:text-lg font-semibold text-left",children:o.name}),i("span",{className:"bg-gray-100 text-gray-800 text-sm font-medium mr-2 px-2.5 py-0.5 rounded-full hidden md:block",children:"Default"})]}),i("p",{className:"text-coolGray-600 font-medium text-sm md:text-md",children:o.description})]})]})})})}var h={},k={},N={};Object.defineProperty(N,"__esModule",{value:!0});N.compose=function(){for(var o=arguments.length,r=Array(o),e=0;e<o;e++)r[e]=arguments[e];return function(){for(var t=arguments.length,a=Array(t),l=0;l<t;l++)a[l]=arguments[l];r.forEach(function(n){return n&&n.apply(void 0,a)})}};N.pick=function(o){for(var r=arguments.length,e=Array(r>1?r-1:0),t=1;t<r;t++)e[t-1]=arguments[t];return e.reduce(function(a,l){return o&&o.hasOwnProperty(l)&&(a[l]=o[l]),a},{})};Object.defineProperty(k,"__esModule",{value:!0});var v=Object.assign||function(s){for(var o=1;o<arguments.length;o++){var r=arguments[o];for(var e in r)Object.prototype.hasOwnProperty.call(r,e)&&(s[e]=r[e])}return s},xe=function(){function s(o,r){for(var e=0;e<r.length;e++){var t=r[e];t.enumerable=t.enumerable||!1,t.configurable=!0,"value"in t&&(t.writable=!0),Object.defineProperty(o,t.key,t)}}return function(o,r,e){return r&&s(o.prototype,r),e&&s(o,e),o}}(),we=w.exports,Se=C(we),_e=ue.exports,d=C(_e),Ne=fe,Ae=C(Ne),m=N;function C(s){return s&&s.__esModule?s:{default:s}}function Pe(s,o){if(!(s instanceof o))throw new TypeError("Cannot call a class as a function")}function Ie(s,o){if(!s)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return o&&(typeof o=="object"||typeof o=="function")?o:s}function ke(s,o){if(typeof o!="function"&&o!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof o);s.prototype=Object.create(o&&o.prototype,{constructor:{value:s,enumerable:!1,writable:!0,configurable:!0}}),o&&(Object.setPrototypeOf?Object.setPrototypeOf(s,o):s.__proto__=o)}var Ce=function(o){return{mainText:o.main_text,secondaryText:o.secondary_text}},O=function(s){ke(o,s);function o(r){Pe(this,o);var e=Ie(this,(o.__proto__||Object.getPrototypeOf(o)).call(this,r));return e.init=function(){if(!window.google)throw new Error("[react-places-autocomplete]: Google Maps JavaScript API library must be loaded. See: https://github.com/kenny-hibino/react-places-autocomplete#load-google-library");if(!window.google.maps.places)throw new Error("[react-places-autocomplete]: Google Maps Places library must be loaded. Please add `libraries=places` to the src URL. See: https://github.com/kenny-hibino/react-places-autocomplete#load-google-library");e.autocompleteService=new window.google.maps.places.AutocompleteService,e.autocompleteOK=window.google.maps.places.PlacesServiceStatus.OK,e.setState(function(t){return t.ready?null:{ready:!0}})},e.autocompleteCallback=function(t,a){if(e.setState({loading:!1}),a!==e.autocompleteOK){e.props.onError(a,e.clearSuggestions);return}var l=e.props.highlightFirstSuggestion;e.setState({suggestions:t.map(function(n,_){return{id:n.id,description:n.description,placeId:n.place_id,active:!!(l&&_===0),index:_,formattedSuggestion:Ce(n.structured_formatting),matchedSubstrings:n.matched_substrings,terms:n.terms,types:n.types}})})},e.fetchPredictions=function(){var t=e.props.value;t.length&&(e.setState({loading:!0}),e.autocompleteService.getPlacePredictions(v({},e.props.searchOptions,{input:t}),e.autocompleteCallback))},e.clearSuggestions=function(){e.setState({suggestions:[]})},e.clearActive=function(){e.setState({suggestions:e.state.suggestions.map(function(t){return v({},t,{active:!1})})})},e.handleSelect=function(t,a,l){e.clearSuggestions(),e.props.onSelect?e.props.onSelect(t,a,l):e.props.onChange(t)},e.getActiveSuggestion=function(){return e.state.suggestions.find(function(t){return t.active})},e.selectActiveAtIndex=function(t){var a=e.state.suggestions.find(function(l){return l.index===t}).description;e.setActiveAtIndex(t),e.props.onChange(a)},e.selectUserInputValue=function(){e.clearActive(),e.props.onChange(e.state.userInputValue)},e.handleEnterKey=function(){var t=e.getActiveSuggestion();t===void 0?e.handleSelect(e.props.value,null,null):e.handleSelect(t.description,t.placeId,t)},e.handleDownKey=function(){if(e.state.suggestions.length!==0){var t=e.getActiveSuggestion();t===void 0?e.selectActiveAtIndex(0):t.index===e.state.suggestions.length-1?e.selectUserInputValue():e.selectActiveAtIndex(t.index+1)}},e.handleUpKey=function(){if(e.state.suggestions.length!==0){var t=e.getActiveSuggestion();t===void 0?e.selectActiveAtIndex(e.state.suggestions.length-1):t.index===0?e.selectUserInputValue():e.selectActiveAtIndex(t.index-1)}},e.handleInputKeyDown=function(t){switch(t.key){case"Enter":t.preventDefault(),e.handleEnterKey();break;case"ArrowDown":t.preventDefault(),e.handleDownKey();break;case"ArrowUp":t.preventDefault(),e.handleUpKey();break;case"Escape":e.clearSuggestions();break}},e.setActiveAtIndex=function(t){e.setState({suggestions:e.state.suggestions.map(function(a,l){return l===t?v({},a,{active:!0}):v({},a,{active:!1})})})},e.handleInputChange=function(t){var a=t.target.value;if(e.props.onChange(a),e.setState({userInputValue:a}),!a){e.clearSuggestions();return}e.props.shouldFetchSuggestions&&e.debouncedFetchPredictions()},e.handleInputOnBlur=function(){e.mousedownOnSuggestion||e.clearSuggestions()},e.getActiveSuggestionId=function(){var t=e.getActiveSuggestion();return t?"PlacesAutocomplete__suggestion-"+t.placeId:void 0},e.getIsExpanded=function(){return e.state.suggestions.length>0},e.getInputProps=function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(t.hasOwnProperty("value"))throw new Error("[react-places-autocomplete]: getInputProps does not accept `value`. Use `value` prop instead");if(t.hasOwnProperty("onChange"))throw new Error("[react-places-autocomplete]: getInputProps does not accept `onChange`. Use `onChange` prop instead");var a={type:"text",autoComplete:"off",role:"combobox","aria-autocomplete":"list","aria-expanded":e.getIsExpanded(),"aria-activedescendant":e.getActiveSuggestionId(),disabled:!e.state.ready};return v({},a,t,{onKeyDown:(0,m.compose)(e.handleInputKeyDown,t.onKeyDown),onBlur:(0,m.compose)(e.handleInputOnBlur,t.onBlur),value:e.props.value,onChange:function(n){e.handleInputChange(n)}})},e.getSuggestionItemProps=function(t){var a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},l=e.handleSuggestionMouseEnter.bind(e,t.index),n=e.handleSuggestionClick.bind(e,t);return v({},a,{key:t.id,id:e.getActiveSuggestionId(),role:"option",onMouseEnter:(0,m.compose)(l,a.onMouseEnter),onMouseLeave:(0,m.compose)(e.handleSuggestionMouseLeave,a.onMouseLeave),onMouseDown:(0,m.compose)(e.handleSuggestionMouseDown,a.onMouseDown),onMouseUp:(0,m.compose)(e.handleSuggestionMouseUp,a.onMouseUp),onTouchStart:(0,m.compose)(e.handleSuggestionTouchStart,a.onTouchStart),onTouchEnd:(0,m.compose)(e.handleSuggestionMouseUp,a.onTouchEnd),onClick:(0,m.compose)(n,a.onClick)})},e.handleSuggestionMouseEnter=function(t){e.setActiveAtIndex(t)},e.handleSuggestionMouseLeave=function(){e.mousedownOnSuggestion=!1,e.clearActive()},e.handleSuggestionMouseDown=function(t){t.preventDefault(),e.mousedownOnSuggestion=!0},e.handleSuggestionTouchStart=function(){e.mousedownOnSuggestion=!0},e.handleSuggestionMouseUp=function(){e.mousedownOnSuggestion=!1},e.handleSuggestionClick=function(t,a){a&&a.preventDefault&&a.preventDefault();var l=t.description,n=t.placeId;e.handleSelect(l,n,t),setTimeout(function(){e.mousedownOnSuggestion=!1})},e.state={loading:!1,suggestions:[],userInputValue:r.value,ready:!r.googleCallbackName},e.debouncedFetchPredictions=(0,Ae.default)(e.fetchPredictions,r.debounce),e}return xe(o,[{key:"componentDidMount",value:function(){var e=this.props.googleCallbackName;if(e){var t=window.google&&window.google.maps&&window.google.maps.places;t?this.init():window[e]=this.init}else this.init()}},{key:"componentWillUnmount",value:function(){var e=this.props.googleCallbackName;e&&window[e]&&delete window[e]}},{key:"render",value:function(){return this.props.children({getInputProps:this.getInputProps,getSuggestionItemProps:this.getSuggestionItemProps,loading:this.state.loading,suggestions:this.state.suggestions})}}]),o}(Se.default.Component);O.propTypes={onChange:d.default.func.isRequired,value:d.default.string.isRequired,children:d.default.func.isRequired,onError:d.default.func,onSelect:d.default.func,searchOptions:d.default.shape({bounds:d.default.object,componentRestrictions:d.default.object,location:d.default.object,offset:d.default.oneOfType([d.default.number,d.default.string]),radius:d.default.oneOfType([d.default.number,d.default.string]),types:d.default.array}),debounce:d.default.number,highlightFirstSuggestion:d.default.bool,shouldFetchSuggestions:d.default.bool,googleCallbackName:d.default.string};O.defaultProps={onError:function(o,r){return console.error(`[react-places-autocomplete]: error happened when fetching data from Google Maps API.
Please check the docs here (https://developers.google.com/maps/documentation/javascript/places#place_details_responses)
Status: `,o)},searchOptions:{},debounce:200,highlightFirstSuggestion:!1,shouldFetchSuggestions:!0};k.default=O;var S={};Object.defineProperty(S,"__esModule",{value:!0});S.geocodeByAddress=function(o){var r=new window.google.maps.Geocoder,e=window.google.maps.GeocoderStatus.OK;return new Promise(function(t,a){r.geocode({address:o},function(l,n){n!==e&&a(n),t(l)})})};S.getLatLng=function(o){return new Promise(function(r,e){try{var t={lat:o.geometry.location.lat(),lng:o.geometry.location.lng()};r(t)}catch(a){e(a)}})};S.geocodeByPlaceId=function(o){var r=new window.google.maps.Geocoder,e=window.google.maps.GeocoderStatus.OK;return new Promise(function(t,a){r.geocode({placeId:o},function(l,n){n!==e&&a(n),t(l)})})};Object.defineProperty(h,"__esModule",{value:!0});var H=h.getLatLng=h.geocodeByPlaceId=z=h.geocodeByAddress=void 0,Oe=k,Ee=Le(Oe),E=S;function Le(s){return s&&s.__esModule?s:{default:s}}var z=h.geocodeByAddress=E.geocodeByAddress;h.geocodeByPlaceId=E.geocodeByPlaceId;H=h.getLatLng=E.getLatLng;var Me=h.default=Ee.default;function De({handleShow:s,id:o}){var L,M,D,K,T;const r=de(),[e]=Q(he),t=`${ve}/shops/${e==null?void 0:e.shop_id}/centres`,[a,l]=w.exports.useState(o),{data:n}=pe(["location",a],async()=>await I(`${t}/${a}`),{enabled:!!a,keepPreviousData:!0}),_={shop_id:e==null?void 0:e.shop_id,centre_id:a||"",name:(n==null?void 0:n.name)||"",description:(n==null?void 0:n.description)||"",is_pick_up_centre:(n==null?void 0:n.is_pick_up_centre)||!0,is_active:(n==null?void 0:n.is_active)||!0,longitude:n==null?void 0:n.longitude,latitude:n==null?void 0:n.latitude,address:{street:((L=n==null?void 0:n.address)==null?void 0:L.street)||"",city:((M=n==null?void 0:n.address)==null?void 0:M.city)||"",province:((D=n==null?void 0:n.address)==null?void 0:D.province)||"",area:((K=n==null?void 0:n.address)==null?void 0:K.area)||"",country:((T=n==null?void 0:n.address)==null?void 0:T.country)||""}},Y=c=>(y,Z)=>{c("description",y,!0),z(y).then(p=>{const g=p[0];H(g).then(P=>{c("longitude",P.lng),c("latitude",P.lat)});const f=g.address_components.reverse();c("address.street",f[f.length-1].short_name),c("address.city",f[f.length-1].short_name),c("address.area",f[2].short_name),c("address.province",f[1].short_name),c("address.country",f[0].short_name)}).catch(p=>{})},{mutate:V}=J(c=>I(t,{method:"POST",body:JSON.stringify(c)}),{onSuccess:c=>{l(c.centre_id),r.setQueryData(["location",c.centre_id],c),W("Location created successfully")},onError:c=>{W("Location creation failed due to "+c.message)}}),{mutate:X}=J(c=>I(`${t}/${a}`,{method:"PATCH",body:JSON.stringify(c)}),{onSuccess:c=>{l(c.centre_id),r.setQueryData(["location",c.centre_id],c)},onError:c=>{}});return i($,{children:i(me,{initialValues:_,onSubmit:(c,{setSubmitting:y})=>{!a||a===""?V(x({},c)):X(x({},c)),y(!1)},children:({values:c,errors:y,touched:Z,handleChange:p,handleBlur:g,setFieldValue:A,setFieldError:f,setValues:P,setFieldTouched:Ke,handleSubmit:ee,isSubmitting:Te})=>{var B,U,j;return u("div",{className:"flex-grow",children:[u("div",{className:"md:p-6 p-4 space-y-6",children:[i("h2",{className:"text-2xl text-gray-800 font-bold mb-5",children:"Locations"}),u("section",{children:[i("h3",{className:"text-xl leading-snug text-gray-800 font-bold mb-1",children:"Shipping Locations"}),u("div",{className:"text-sm",children:["These are the places where you ship your orders from",i("br",{}),"(Could be from a warehouse, your home, a fulfilment partner)"]}),i("div",{className:"sm:flex sm:w-1/2 sm:items-center space-y-4 sm:space-y-0 sm:space-x-4 mt-5",children:u("div",{className:"w-full",children:[i("label",{className:"block text-sm font-medium mb-1",htmlFor:"name",children:"Name"}),i("input",{id:"name",name:"name",onChange:p,onBlur:g,value:c.name,className:"form-input w-full",type:"text",placeholder:"E.g. Rocketship Kumasi warehouse",required:!0})]})}),i("div",{className:"sm:flex sm:w-1/2 sm:items-center space-y-4 sm:space-y-0 sm:space-x-4 mt-5",children:u("div",{className:"w-full",children:[i("label",{className:"block text-sm font-medium mb-1",htmlFor:"description",children:"Address"}),i(Me,{value:c.description,onSelect:Y(A),onChange:b=>A("description",b),children:({getInputProps:b,getSuggestionItemProps:te,suggestions:oe,loading:ne})=>u("div",{children:[i("input",x({className:"form-input w-full",id:"description",name:"description",placeholder:"Enter Address"},b())),u("div",{className:"autocomplete-dropdown-container",children:[ne&&i("div",{children:"Loading..."}),oe.map((F,se)=>w.exports.createElement("div",q(x({className:"cursor-pointer"},te(F)),{key:se}),i("span",{children:F.description})))]})]})})]})}),u("section",{className:"sm:flex sm:w-1/2 sm:items-center space-y-4 sm:space-y-0 sm:space-x-4 mt-5",children:[u("div",{className:"w-full sm:w-1/2",children:[i("label",{className:"block text-sm font-medium mb-1",htmlFor:"address.country",children:"Country"}),u("select",{id:"address.country",name:"address.country",autoComplete:"country",className:"form-select block",value:(B=c.address)==null?void 0:B.country,onChange:p,children:[i("option",{value:"",children:"Please Select"}),i("option",{value:"GH",children:"Ghana"}),i("option",{value:"NG",children:"Nigeria"}),i("option",{value:"RW",children:"Rwanda"}),i("option",{value:"KY",children:"Kenya"}),i("option",{value:"SA",children:"South Africa"})]})]}),u("div",{className:"w-full sm:w-1/2",children:[i("label",{className:"block text-sm font-medium mb-1",htmlFor:"address.city",children:"City"}),i("input",{id:"address.city",name:"address.city",className:"form-input w-full",type:"text",onChange:p,onBlur:g,value:(U=c.address)==null?void 0:U.city,placeholder:"Kumasi"})]})]}),i("div",{className:"sm:flex sm:w-1/2 sm:items-center space-y-4 sm:space-y-0 sm:space-x-4 mt-5",children:u("div",{className:"w-full",children:[i("label",{className:"block text-sm font-medium mb-1",htmlFor:"address.province",children:"Province or Region"}),i("input",{id:"address.province",name:"address.province",className:"form-input w-full",type:"text",onChange:p,onBlur:g,value:(j=c.address)==null?void 0:j.province,autoComplete:"region",placeholder:"Ashanti Region"})]})}),u("div",{className:"sm:flex sm:items-center space-y-4 sm:space-y-0 sm:space-x-4 mt-5",children:[u("div",{className:"flex items-center sm:w-1/2",children:[i("input",{className:"form-checkbox",id:"is_pick_up_centre",name:"is_pick_up_centre",type:"checkbox",onChange:p,onBlur:g,checked:c.is_pick_up_centre}),i("label",{className:"block text-sm ml-2 ",htmlFor:"pickup",children:"Do you allow pickup from this location?"})]}),u("div",{className:"flex items-center sm:w-1/2",children:[i("input",{className:"form-checkbox",id:"is_active",name:"is_active",type:"checkbox",onChange:p,onBlur:g,checked:c.is_active}),i("label",{className:"block text-sm ml-2",htmlFor:"active",children:"Active"})]})]})]})]}),i("footer",{className:"sticky bottom-0",children:i("div",{className:"flex flex-col px-6 py-5 border-t border-gray-200",children:u("div",{className:"flex self-end",children:[i("button",{onClick:()=>s(!1),className:"btn border-gray-200 hover:border-gray-300 text-gray-600",children:"Cancel"}),i("button",{onClick:b=>{b.stopPropagation(),ee()},className:"btn bg-blue-600 bg-opacity-100 rounded-lg  text-white ml-3",children:"Save Changes"})]})})})]})}})})}function Ge(){const[s]=Q(ye),[o,r]=w.exports.useState(!1),[e,t]=w.exports.useState(),a=(l,n)=>{t(n),r(l)};return u("div",{className:"flex-grow",children:[o&&i(De,{handleShow:a,id:e}),!o&&u("div",{className:"md:p-6 p-4 space-y-6",children:[u("div",{className:"flex justify-between",children:[i("div",{children:i("h2",{className:"text-2xl text-gray-800 font-bold mb-4",children:"Locations"})}),i("button",{onClick:()=>r(!o),type:"button",className:"text-white bg-blue-900 hover:bg-purple-800 focus:ring-4 focus:ring-purple-300 font-medium rounded-lg text-sm px-5 py-2.5 text-center mr-3 mb-3",children:"Add Location"})]}),i("div",{className:"text-sm",children:"Locations that you ship/deliver your orders from"}),ge(s)?"No locations to show":i("section",{children:Object.values(s||[]).map((l,n)=>i(be,{location:l,handleShow:a},n))})]})]})}export{Ge as default};
