var K=Object.defineProperty,L=Object.defineProperties;var U=Object.getOwnPropertyDescriptors;var T=Object.getOwnPropertySymbols;var z=Object.prototype.hasOwnProperty,X=Object.prototype.propertyIsEnumerable;var k=(e,i,r)=>i in e?K(e,i,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[i]=r,p=(e,i)=>{for(var r in i||(i={}))z.call(i,r)&&k(e,r,i[r]);if(T)for(var r of T(i))X.call(i,r)&&k(e,r,i[r]);return e},g=(e,i)=>L(e,U(i));import{D as Y,I as Z,u as C,e as A,g as w,d as t,m as R,F as V,j as a,_ as D,J as n,c as I,b as ee,k as te}from"./vendor.b5508bda.js";import{m as x,c as F,s as se,f as y,d as P,e as q,g as f,r as u,h as N}from"./index.e01deede.js";function $(e){return{shop_id:e.shop_id,cities:e.cities,price_per_order:F(e.price_per_order_amt),price_per_item:F(e.price_per_item_amt),name:e.name,code:e.name,description:e.description}}function ie(e){return{shop_id:(e==null?void 0:e.shop_id)||"",cities:e==null?void 0:e.cities,price_per_order_amt:x(e==null?void 0:e.price_per_order),price_per_item_amt:x(e==null?void 0:e.price_per_item),price_per_weight_amt:x(e==null?void 0:e.price_per_weight),name:(e==null?void 0:e.name)||"",free_shipping_threshold:x(e==null?void 0:e.free_shipping_threshold),description:(e==null?void 0:e.description)||"",model:e&&"price_per_item"in e?{label:"Item Based",value:"ITEM_BASED"}:{label:"Weight Based",value:"WEIGHT_BASED"}}}const M=Y();function re({handleShow:e,rate:i}){const r=Z(),[l]=C(se),d=`${y}/shops/${l==null?void 0:l.shop_id}/wbrs`,h=`${y}/shops/${l==null?void 0:l.shop_id}/ibrs`,[_,b]=A.exports.useState(i==null?void 0:i.rate_id),W=g(p({},ie(i)),{shop_id:l==null?void 0:l.shop_id}),{mutate:G}=w(s=>u(d,{method:"POST",body:JSON.stringify(s)}),{onSuccess:s=>{b(s.rate_id),r.invalidateQueries(["weight-based-rates",l==null?void 0:l.shop_id]),n("Rate created successfully")},onError:s=>{n("Rate creation failed due to "+s.message)}}),{mutate:j}=w(s=>u(`${d}/${_}`,{method:"PATCH",body:JSON.stringify(s)}),{onSuccess:s=>{b(s.rate_id),r.invalidateQueries(["weight-based-rates",l==null?void 0:l.shop_id]),n("Rate created successfully")},onError:s=>{n("Rate creation failed due to "+s.message)}}),{mutate:H}=w(s=>u(h,{method:"POST",body:JSON.stringify(s)}),{onSuccess:s=>{b(s.rate_id),r.invalidateQueries(["item-based-rates",l==null?void 0:l.shop_id]),n("Rate created successfully")},onError:s=>{n("Rate creation failed due to "+s.message)}}),{mutate:Q}=w(s=>u(`${h}/${_}`,{method:"PATCH",body:JSON.stringify(s)}),{onSuccess:s=>{b(s.rate_id),r.invalidateQueries(["item-based-rates",l==null?void 0:l.shop_id]),n("Rate created successfully")},onError:s=>{n("Rate creation failed due to "+s.message)}});return t(R,{children:t(V,{initialValues:W,onSubmit:(s,{setSubmitting:E})=>{var S,o;!_||_===""?((S=s.model)==null?void 0:S.value)==="WEIGHT_BASED"?G(O()):H($(s)):((o=s.model)==null?void 0:o.value)==="ITEM_BASED"?j(O()):Q($(s)),E(!1)},children:({values:s,errors:E,touched:S,handleChange:o,handleBlur:B,setFieldValue:m,setFieldError:ne,setValues:me,setFieldTouched:de,handleSubmit:J,isSubmitting:pe})=>a("div",{className:"w-full flex-grow",children:[a("div",{className:"md:p-6 p-4 space-y-6",children:[t("h2",{className:"text-2xl text-gray-800 font-bold mb-5",children:"Rates"}),a("section",{children:[t("h3",{className:"text-xl leading-snug text-gray-800 font-bold mb-1",children:"Shipping Rates"}),t("div",{className:"text-sm",children:"Delight customers with free and low shipping rates"}),t("div",{className:"sm:flex sm:items-center space-y-4 sm:space-y-0 sm:space-x-4 mt-5",children:a("div",{className:"w-full md:w-1/2 sm:w-full",children:[t("label",{className:"block text-sm font-medium mb-1",htmlFor:"name",children:"Name"}),t("input",{id:"name",name:"name",onChange:o,onBlur:B,value:s.name,className:"form-input w-full",type:"text",placeholder:"E.g. Accra Central Rates-1",required:!0})]})}),a("div",{className:"w-full md:w-1/2 sm:w-full mt-2",children:[t("label",{className:"block text-sm font-medium mb-1",htmlFor:"name",children:"Description"}),t("input",{id:"description",name:"description",onChange:o,onBlur:B,value:s.description,className:"form-input w-full",type:"text",placeholder:"E.g. Ashanti Regional Rates-2",required:!0})]}),t("div",{className:"w-full md:w-1/2 sm:w-full mt-2",children:a("div",{className:"w-full",children:[t("label",{className:"block text-sm font-medium mb-1",htmlFor:"model",children:"Model"}),t(D,{id:"model",name:"model",closeMenuOnSelect:!0,defaultValue:s.model,value:s.model,isSearchable:!0,onChange:c=>m("model",c),components:M,options:P,styles:p({input:c=>g(p({},c),{"input:focus":{boxShadow:"none"}})},q),className:"w-full"})]})})]}),s.model&&s.model.value==="WEIGHT_BASED"&&a("section",{className:"sm:flex w-full sm:items-center align-middle sm:w-1/2 items-center space-y-4 sm:space-y-0 sm:space-x-4 mt-5",children:[a("div",{className:"w-full md:w-1/3 sm:w-full",children:[t("label",{className:"block text-sm font-medium mb-1",htmlFor:"price-per-order",children:"Price per order"}),t("input",{id:"price_per_order_amt",name:"price_per_order_amt",onChange:o,onBlur:c=>m("price_per_order_amt",f(c.currentTarget.value).toString()),value:s.price_per_order_amt,className:"form-input w-full",type:"text",placeholder:"0.00"})]}),t("div",{className:"sm:mt-3 self-center text-lg",children:t("h1",{children:"+"})}),a("div",{className:"w-full md:w-1/3 sm:w-full",children:[t("label",{className:"block text-sm font-medium mb-1",htmlFor:"price-per-weight_amt",children:"Price per gram"}),t("input",{id:"price_per_weight_amt",name:"price_per_weight_amt",onChange:o,onBlur:c=>m("price_per_weight_amt",f(c.currentTarget.value).toString()),value:s.price_per_weight_amt,className:"form-input w-full",type:"text",placeholder:"1.00"})]})]}),s.model&&s.model.value==="ITEM_BASED"&&a(R,{children:[a("section",{className:"sm:flex w-full sm:items-center align-middle sm:w-1/2 items-center space-y-2 sm:space-y-0 sm:space-x-4 mt-3",children:[a("div",{className:"w-full md:w-1/3 sm:w-full",children:[t("label",{className:"block text-sm font-medium mb-1",htmlFor:"price-per-order",children:"Price per order"}),t("input",{id:"price_per_order_amt",name:"price_per_order_amt",onChange:o,onBlur:c=>m("price_per_order_amt",f(c.currentTarget.value).toString()),value:s.price_per_order_amt,className:"form-input w-full",type:"text",placeholder:"0.00"})]}),t("div",{className:"self-center text-lg",children:t("h1",{children:"+"})}),a("div",{className:"w-full md:w-1/3 sm:w-full",children:[t("label",{className:"block text-sm font-medium mb-1",htmlFor:"price-per-item_amt",children:"Price per item"}),t("input",{id:"price_per_item_amt",name:"price_per_item_amt",onChange:o,onBlur:c=>m("price_per_item_amt",f(c.currentTarget.value).toString()),value:s.price_per_item_amt,className:"form-input w-full",type:"text",placeholder:"1.00"})]})]}),t("section",{children:a("div",{className:"w-full md:w-1/2 sm:w-full",children:[t("label",{className:"block text-sm font-medium mb-1",htmlFor:"free-shipping-threshold",children:"Free shipping at"}),t("input",{id:"free_shipping_threshold",name:"free_shipping_threshold",onChange:o,onBlur:c=>m("free_shipping_threshold",f(c.currentTarget.value).toString()),value:s.free_shipping_threshold,className:"form-input w-full",type:"text",placeholder:"1.00"})]})})]}),s.model&&s.model.value==="WEIGHT_BANDED"&&t("section",{children:"Render weight banded model form"}),s.model&&s.model.value==="PRICE_BANDED"&&t("section",{children:"Render price banded model form"}),t("div",{className:"w-full md:w-1/2 sm:w-full",children:a("div",{className:"w-full",children:[t("label",{className:"block text-sm font-medium mb-1",htmlFor:"cities",children:"Regions/Cities"}),t(D,{id:"cities",name:"cities",closeMenuOnSelect:!0,isMulti:!0,isClearable:!0,defaultValue:s.cities,value:s.cities,isSearchable:!0,onChange:c=>m("cities",c),components:M,options:P,styles:p({input:c=>g(p({},c),{"input:focus":{boxShadow:"none"}})},q),className:"w-full"})]})})]}),t("footer",{className:"sticky bottom-0",children:t("div",{className:"flex flex-col px-6 py-5 border-t border-gray-200",children:a("div",{className:"flex self-end",children:[t("button",{onClick:()=>e(!1),className:"btn border-gray-200 hover:border-gray-300 text-gray-600",children:"Cancel"}),t("button",{onClick:c=>{c.stopPropagation(),J()},className:"btn bg-blue-600 bg-opacity-100 rounded-lg  text-white ml-3",children:"Save Changes"})]})})})]})})})}function O(e){throw new Error("Function not implemented.")}function le({handleShow:e,rate:i}){return t(R,{children:t("div",{onClick:r=>e(!0,i),className:"py-1 px-3 mb-4 md:p-5 text-coolGray-800 shadow rounded-lg",children:a("div",{className:"flex md:space-y-0 md:space-x-6 align-top",children:[t("img",{src:"https://source.unsplash.com/70x70/?portrait",alt:"",className:"md:self-center self-start flex-shrink-0 w-20 h-20 border rounded-sm justify-self-start bg-coolGray-500 border-coolGray-300"}),a("div",{className:"flex flex-col px-3 md:px-0",children:[t("div",{className:"flex md:space-x-6 flex-row",children:t("h4",{className:"text-sm md:text-lg font-semibold text-left",children:i.name})}),t("p",{className:"text-coolGray-600 font-medium text-sm md:text-md",children:i.description})]})]})})})}const v=[],ae=I(e=>({queryKey:["weight-based-rates",e(N)],queryFn:async({queryKey:[,i]})=>{const r=await u(`${y}/shops/${i}/wbrs`);return(r==null?void 0:r.rates)||v},initialData:v,keepPreviousData:!0,enabled:!!e(N)})),ce=I(e=>({queryKey:["item-based-rates",e(N)],queryFn:async({queryKey:[,i]})=>{const r=await u(`${y}/shops/${i}/ibrs`);return(r==null?void 0:r.rates)||v},initialData:v,keepPreviousData:!0,enabled:!!e(N)})),oe=ee(e=>{let i=[];const r=e(ce);r&&i.push(...r);const l=e(ae);return l&&i.push(...l),i});function _e(){const[e]=C(oe),[i,r]=A.exports.useState(!1),l=(d,h)=>{r(d)};return a("div",{className:"flex-grow",children:[i&&t(re,{handleShow:l,rate:null}),!i&&a("div",{className:"md:p-6 p-4 space-y-6",children:[a("div",{className:"flex justify-between",children:[t("div",{children:t("h2",{className:"text-2xl text-gray-800 font-bold",children:"Rates"})}),t("button",{onClick:()=>r(!i),type:"button",className:"text-white cursor-pointer bg-blue-600 hover:bg-blue-800 focus:ring-4 focus:ring-purple-300 font-medium rounded-lg text-sm px-5 py-2.5 text-center mr-3 mb-3",children:"Add Rate"})]}),t("div",{className:"text-sm",children:"Rates to charge your customers at checkout"}),te(e)?"No shipping rates to show":t("section",{children:(e||[]).map((d,h)=>t(le,{rate:d,handleShow:l},h))})]})]})}export{_e as default};
